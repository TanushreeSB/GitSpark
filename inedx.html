<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GitSpark ¬∑ precision metrics</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --bg-deep: #0c0a1f;
      --bg-card: rgba(18, 14, 38, 0.8);
      --accent-glow: #7c3aed;
      --accent-soft: #a78bfa;
      --text-bright: #f0f2f5;
      --text-muted: #b9b4d9;
      --border-glow: rgba(167, 139, 250, 0.25);
      --shadow-heavy: 0 30px 60px -10px rgba(0, 0, 0, 0.8);
      --font-main: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    body {
      min-height: 100vh;
      background: radial-gradient(circle at 30% 10%, #2e1a4a, #0b0720 60%);
      font-family: var(--font-main);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem 1.5rem;
      color: var(--text-bright);
    }

    .app {
      max-width: 1200px;
      width: 100%;
    }

    /* header / logo */
    .hero-header {
      text-align: center;
      margin-bottom: 2rem;
    }

    .logo-pretty {
      display: inline-flex;
      align-items: center;
      gap: 12px;
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(8px);
      padding: 0.7rem 2rem;
      border-radius: 80px;
      border: 1px solid rgba(167, 139, 250, 0.3);
      box-shadow: 0 10px 30px -15px #b886f0;
      margin-bottom: 1rem;
    }

    .logo-icon {
      font-size: 2rem;
      color: #f0e9ff;
      filter: drop-shadow(0 0 8px #c084fc);
    }

    .logo-text {
      font-size: 2rem;
      font-weight: 700;
      letter-spacing: 2px;
      background: linear-gradient(130deg, #ffffff, #d8b4fe, #f0abfc);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .tagline-glow {
      font-size: 1.3rem;
      font-weight: 400;
      color: #ccc7f0;
      text-shadow: 0 0 12px #b47aff;
      max-width: 600px;
      margin: 0 auto;
    }

    /* BIGGER PRETTY TERMINAL */
    .terminal-card {
      background: rgba(10, 6, 25, 0.7);
      backdrop-filter: blur(16px);
      border: 2px solid rgba(168, 139, 250, 0.5);
      border-radius: 42px;
      box-shadow: 0 35px 70px -10px #000000cc, 0 0 0 1px rgba(190, 150, 255, 0.3) inset;
      padding: 1.8rem 2rem 2rem;
      margin-bottom: 3.5rem;
      transition: box-shadow 0.2s;
    }

    .terminal-card:hover {
      box-shadow: 0 40px 80px -5px #5b3b8c, 0 0 0 2px rgba(200, 170, 255, 0.5) inset;
    }

    .terminal-top {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 1.2rem;
    }

    .dot-group {
      display: flex;
      gap: 10px;
    }

    .dot {
      width: 15px;
      height: 15px;
      border-radius: 50%;
      box-shadow: 0 0 8px currentColor;
    }
    .dot-red { background: #ff5f56; box-shadow: 0 0 12px #ff5f56; }
    .dot-amber { background: #ffbd2e; box-shadow: 0 0 12px #ffbd2e; }
    .dot-green { background: #27c93f; box-shadow: 0 0 12px #27c93f; }

    .terminal-title {
      margin-left: auto;
      font-family: 'Fira Code', monospace;
      font-size: 1.1rem;
      background: rgba(255,255,255,0.02);
      padding: 5px 15px;
      border-radius: 40px;
      border: 1px solid #5f4b8a;
      color: #d6c7ff;
      letter-spacing: 0.5px;
    }

    .terminal-prompt {
      font-size: 1.2rem;
      font-family: 'Fira Code', monospace;
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      margin-bottom: 0.5rem;
      background: rgba(0,0,0,0.25);
      padding: 0.8rem 1.2rem;
      border-radius: 60px;
      border: 1px dashed #7b68b0;
    }

    .prompt-sign {
      color: #b48aff;
      font-weight: 600;
    }
    .prompt-hint {
      color: #a99bd1;
    }

    .pretty-form {
      margin-top: 1.2rem;
    }

    .input-group {
      display: flex;
      gap: 12px;
      align-items: center;
      background: rgba(0, 0, 0, 0.4);
      border-radius: 80px;
      padding: 0.4rem 0.4rem 0.4rem 1.5rem;
      border: 1px solid #6b4e9e;
      transition: all 0.2s;
    }
    .input-group:focus-within {
      border-color: #c59bff;
      box-shadow: 0 0 25px #aa7eff;
    }

    .input-group i {
      color: #c7adff;
      font-size: 1.3rem;
    }

    .pretty-input {
      flex: 1;
      background: transparent;
      border: none;
      padding: 1rem 0.5rem;
      font-size: 1.1rem;
      color: white;
      outline: none;
    }
    .pretty-input::placeholder {
      color: #7f71a5;
      font-style: italic;
    }

    .pretty-button {
      background: linear-gradient(145deg, #8b5cf6, #c084fc);
      border: none;
      border-radius: 60px;
      padding: 0.9rem 2.2rem;
      color: white;
      font-weight: 600;
      font-size: 1.1rem;
      display: flex;
      align-items: center;
      gap: 12px;
      cursor: pointer;
      box-shadow: 0 10px 25px #6d28d9, 0 0 15px #c084fc;
      transition: all 0.2s;
      border: 1px solid #ffffff50;
    }
    .pretty-button i {
      font-size: 1.3rem;
      filter: drop-shadow(0 0 5px white);
    }
    .pretty-button:hover {
      transform: scale(1.02);
      background: linear-gradient(145deg, #9f7aff, #d8a9ff);
      box-shadow: 0 15px 35px #8b44ff;
    }

    .form-hint {
      margin-top: 0.8rem;
      font-size: 0.9rem;
      color: #b7abe0;
      display: flex;
      align-items: center;
      gap: 8px;
      padding-left: 1rem;
    }
    .form-hint i {
      color: #fdba74;
    }

    .status-badge {
      margin-top: 0.8rem;
      font-size: 0.9rem;
      min-height: 24px;
    }

    /* BIG FEATURE CARDS WITH ICONS */
    .features-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 30px;
      margin: 2rem 0 0;
    }

    .feature-card {
      background: rgba(22, 16, 44, 0.7);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(192, 132, 252, 0.5);
      border-radius: 40px;
      padding: 2.5rem 1.8rem 2.8rem;
      box-shadow: 0 30px 40px -20px black, 0 0 0 1px #ab7eff40 inset;
      transition: all 0.2s;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      text-align: left;
    }

    .feature-card:hover {
      border-color: #d8a9ff;
      box-shadow: 0 30px 55px -15px #b77eff;
      transform: translateY(-5px);
    }

    .feature-icon {
      font-size: 2.8rem;
      background: linear-gradient(145deg, #a174ff, #efb6ff);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      margin-bottom: 1.2rem;
      filter: drop-shadow(0 0 10px #c58aff);
    }

    .feature-card h3 {
      font-size: 1.8rem;
      font-weight: 600;
      margin-bottom: 0.8rem;
      background: linear-gradient(130deg, #ffffff, #e1c4ff);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .feature-card p {
      font-size: 1rem;
      line-height: 1.5;
      color: #cbbdf2;
      margin: 0;
    }

    .results { display: none; }

    @media (max-width: 800px) {
      .features-grid { grid-template-columns: 1fr; }
      .input-group { flex-wrap: wrap; background: transparent; padding: 0; }
      .pretty-button { width: 100%; justify-content: center; }
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="hero-header">
      <div class="logo-pretty">
        <i class="fas fa-bolt logo-icon"></i>
        <span class="logo-text">GitSpark</span>
        <i class="fas fa-crown" style="color: #f5d742; filter: drop-shadow(0 0 6px gold);"></i>
      </div>
      <div class="tagline-glow">
        <i class="fas fa-chart-line" style="margin-right: 8px;"></i> GitHub portfolio, reimagined
      </div>
    </div>

    <!-- BIG TERMINAL -->
    <div class="terminal-card">
      <div class="terminal-top">
        <div class="dot-group">
          <span class="dot dot-red"></span>
          <span class="dot dot-amber"></span>
          <span class="dot dot-green"></span>
        </div>
        <div class="terminal-title">
          <i class="fas fa-terminal" style="margin-right: 6px;"></i> bash 5.2
        </div>
      </div>

      <div class="terminal-prompt">
        <span class="prompt-sign"><i class="fas fa-chevron-right"></i> gitspark@analyzer:~$</span>
        <span class="prompt-hint"><i class="far fa-keyboard"></i> enter username or profile url</span>
      </div>

      <form id="profile-form" class="pretty-form">
        <div class="input-group">
          <i class="fab fa-github"></i>
          <input type="text" id="profile-input" class="pretty-input" placeholder="e.g. octocat  or  https://github.com/octocat" required />
          <button type="submit" class="pretty-button" id="executeBtn">
            <i class="fas fa-bolt"></i>
            <span>Execute Analysis</span>
            <i class="fas fa-arrow-right"></i>
          </button>
        </div>
        <div class="form-hint">
          <i class="fas fa-shield-alt"></i>
          <span>Uses public data ¬∑ opens new tab with your visual score</span>
        </div>
        <div id="status" class="status-badge"></div>
      </form>
    </div>

    <!-- FEATURE CARDS -->
    <div class="features-grid">
      <div class="feature-card">
        <i class="fas fa-microchip feature-icon"></i>
        <h3>Deep Analysis</h3>
        <p>Repository Quality, Contribution, Code Diversity, Community ‚Äî each scored with proper evaluation.</p>
      </div>
      <div class="feature-card">
        <i class="fas fa-bolt feature-icon"></i>
        <h3>Instant Results</h3>
        <p>Fetch live from GitHub API. Opens a stunning new page with your portfolio breakdown & suggestions.</p>
      </div>
      <div class="feature-card">
        <i class="fas fa-lightbulb feature-icon"></i>
        <h3>Actionable Tips</h3>
        <p>Specific tweaks to level up: from bio polish to repo curation. Straight to the point.</p>
      </div>
    </div>
  </div>

  <script>
    (function() {
      const form = document.getElementById('profile-form');
      const input = document.getElementById('profile-input');
      const statusEl = document.getElementById('status');
      const executeBtn = document.getElementById('executeBtn');

      function extractUsername(raw) {
        try {
          if (raw.includes('github.com')) {
            const url = raw.startsWith('http') ? raw : `https://${raw}`;
            const { pathname } = new URL(url);
            const parts = pathname.split('/').filter(Boolean);
            return parts[0] || null;
          }
        } catch { /* fallback */ }
        const cleaned = raw.replace(/^@/, '');
        if (!cleaned || !/^[a-z\d](?:[a-z\d-]{0,38})?$/i.test(cleaned)) return null;
        return cleaned;
      }

      function setStatus(msg, type) {
        statusEl.innerHTML = msg;
        statusEl.style.color = type === 'error' ? '#fca5a5' : (type === 'success' ? '#b7e4b7' : '#cfc1ff');
      }

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const raw = input.value.trim();
        if (!raw) return;

        const username = extractUsername(raw);
        if (!username) {
          setStatus('‚ùå Invalid GitHub username or URL', 'error');
          return;
        }

        setStatus('‚è≥ Contacting GitHub & opening results...', 'info');
        executeBtn.disabled = true;

        try {
          const userRes = await fetch(`https://api.github.com/users/${encodeURIComponent(username)}`, {
            headers: { Accept: 'application/vnd.github+json' }
          });
          const reposRes = await fetch(`https://api.github.com/users/${encodeURIComponent(username)}/repos?per_page=100&sort=updated`, {
            headers: { Accept: 'application/vnd.github+json' }
          });

          if (!userRes.ok || !reposRes.ok) {
            if (userRes.status === 404) throw { status: 404 };
            else throw { status: userRes.status };
          }

          const userData = await userRes.json();
          const reposData = await reposRes.json();

          const resultWindow = window.open('', '_blank');
          if (!resultWindow) {
            setStatus('‚ö†Ô∏è Pop-up blocked. Allow pop-ups for results.', 'error');
            executeBtn.disabled = false;
            return;
          }

          // Use enhanced analysis with four core metrics
          const analysis = analyzePortfolioEnhanced(userData, reposData);
          const resultHtml = buildPrettyResultPage(userData, analysis);

          resultWindow.document.write(resultHtml);
          resultWindow.document.close();
          setStatus('‚úÖ Results open in new tab!', 'success');
          input.value = '';
        } catch (err) {
          console.error(err);
          if (err.status === 404) setStatus('‚ùå GitHub user not found.', 'error');
          else if (err.status === 403) setStatus('‚ùå Rate limit. Try later.', 'error');
          else setStatus('‚ùå Network / API error.', 'error');
        } finally {
          executeBtn.disabled = false;
        }
      });

      // ---------- ENHANCED ANALYSIS with four specific metrics ----------
      function analyzePortfolioEnhanced(user, repos) {
        const now = new Date();
        const ninetyDaysAgo = new Date(now); ninetyDaysAgo.setDate(now.getDate() - 90);

        // 1. Repository Quality (0-100)
        // factors: has README? (approximated by description), stars per repo, forks per repo, topics?
        const reposWithDesc = repos.filter(r => r.description && r.description.trim().length > 10).length;
        const reposWithStars = repos.filter(r => r.stargazers_count > 0).length;
        const totalStars = repos.reduce((sum, r) => sum + (r.stargazers_count || 0), 0);
        const totalForks = repos.reduce((sum, r) => sum + (r.forks_count || 0), 0);
        const avgStarsPerRepo = repos.length ? totalStars / repos.length : 0;
        const avgForksPerRepo = repos.length ? totalForks / repos.length : 0;
        // quality score: 40% description coverage, 30% stars, 30% forks (with caps)
        const descRatio = repos.length ? reposWithDesc / repos.length : 0;
        const starScore = Math.min(avgStarsPerRepo * 8, 40);   // 5 stars = 40, 10 stars = 80 ‚Üí capped at 40
        const forkScore = Math.min(avgForksPerRepo * 15, 30);  // 2 forks = 30
        let repoQuality = Math.round( (descRatio * 40) + starScore + forkScore );
        repoQuality = Math.min(100, repoQuality);

        // 2. Contribution (activity) (0-100)
        const recentPushes = repos.filter(r => r.pushed_at && new Date(r.pushed_at) >= ninetyDaysAgo).length;
        const contributionScore = Math.min(100, Math.round( (recentPushes / Math.max(repos.length,1)) * 100 ));

        // 3. Code Diversity (0-100)
        const languagesSet = new Set(repos.map(r => r.language).filter(Boolean));
        const langCount = languagesSet.size;
        // 1 language = 25, 2=45, 3=65, 4=80, 5=90, 6+=100
        const diversityMap = {0:0,1:25,2:45,3:65,4:80,5:90};
        let diversityScore = langCount >=6 ? 100 : (diversityMap[langCount] || 0);

        // 4. Community (0-100)
        const followers = user.followers || 0;
        const following = user.following || 0;
        // Community: followers (70%) + organization involvement? (maybe from user company/type) + forks from others?
        // also consider total forks (others forking you)
        const forkCount = totalForks;
        let communityBase = 0;
        if (followers > 500) communityBase = 70;
        else if (followers > 200) communityBase = 60;
        else if (followers > 80) communityBase = 50;
        else if (followers > 30) communityBase = 35;
        else if (followers > 10) communityBase = 25;
        else if (followers > 3) communityBase = 15;
        else communityBase = followers * 4; // 0-12
        // forks bonus (your repos being forked)
        const forkBonus = Math.min(30, forkCount * 0.6);
        let communityScore = Math.min(100, Math.round(communityBase + forkBonus));

        // Overall = weighted average of the four (each 25% or adjust)
        const overall = Math.round( (repoQuality * 0.25) + (contributionScore * 0.25) + (diversityScore * 0.25) + (communityScore * 0.25) );

        // language percentages for visual
        const langCountMap = {};
        repos.forEach(r => { if(r.language) langCountMap[r.language] = (langCountMap[r.language] || 0) + 1; });
        const totalLangRepos = Object.values(langCountMap).reduce((a,b)=>a+b,0);
        const sortedLangs = Object.entries(langCountMap).sort((a,b)=>b[1]-a[1]).slice(0,5);
        const langPercentages = sortedLangs.map(([lang, cnt]) => ({ lang, percent: Math.round((cnt/totalLangRepos)*100) }));

        const suggestions = generateSuggestionsEnhanced({ user, repos, repoQuality, contributionScore, diversityScore, communityScore, overall, totalStars, totalForks, recentPushes, languagesCount: langCount });

        return {
          overall,
          repoQuality,
          contributionScore,
          diversityScore,
          communityScore,
          totalStars,
          totalForks,
          recentActivityReposCount: recentPushes,
          languagesCount: langCount,
          suggestions,
          langPercentages
        };
      }

      function generateSuggestionsEnhanced(ctx) {
        const s = [];
        if (!ctx.user.bio || ctx.user.bio.trim().length < 40) s.push({ text: "Add a detailed bio with your focus and skills.", tagline: "Recruiters look at the top lines first." });
        if (!ctx.user.blog) s.push({ text: "Add a personal website or portfolio link.", tagline: "Makes your work easier to explore." });
        if (ctx.repoQuality < 65) s.push({ text: "Improve repository quality: add README, descriptions, and examples.", tagline: "Repos with clear docs get more stars and forks." });
        if (ctx.contributionScore < 50) s.push({ text: "Increase commit activity: push small changes weekly.", tagline: "Recent activity signals an active developer." });
        if (ctx.diversityScore < 45) s.push({ text: "Experiment with a new language or framework.", tagline: "Show adaptability with diverse tech stacks." });
        if (ctx.communityScore < 40) s.push({ text: "Engage more: star others' repos, contribute to open source.", tagline: "Community builds your network and visibility." });
        if (ctx.overall >= 85 && s.length === 0) s.push({ text: "You're crushing it! Consider mentoring or writing tech articles.", tagline: "Share your expertise to grow further." });
        return s.slice(0,5);
      }

      function buildPrettyResultPage(user, analysis) {
        const scoreDesc = describeScore(analysis.overall);
        const eliteBadge = analysis.overall >= 85 ? '<span class="pill elite-pulse">üèÜ ELITE PORTFOLIO</span>' : '';

        const metrics = [
          ["Repository Quality", `${analysis.repoQuality} / 100`],
          ["Contribution (activity)", `${analysis.contributionScore} / 100`],
          ["Code Diversity", `${analysis.diversityScore} / 100`],
          ["Community", `${analysis.communityScore} / 100`],
          ["Total stars", analysis.totalStars],
          ["Total forks", analysis.totalForks],
          ["Active repos (90d)", analysis.recentActivityReposCount],
          ["Languages used", analysis.languagesCount],
        ];
        let metricsHtml = '';
        for (const [label, val] of metrics) {
          metricsHtml += `<dt class="metrics-label">${label}</dt><dd class="metrics-value">${val}</dd>`;
        }

        const profileHtml = `
          <img class="profile-avatar" src="${user.avatar_url}" alt="avatar">
          <div class="profile-primary">
            <div class="profile-name">${user.name || 'No name set'}</div>
            <a class="profile-login" href="${user.html_url}" target="_blank">@${user.login}</a>
          </div>
          ${user.bio ? `<div class="profile-bio">${user.bio}</div>` : ''}
          <div class="profile-meta">
            ${user.location ? `<span class="pill"><i class="fas fa-map-pin"></i> ${user.location}</span>` : ''}
            <span class="pill"><i class="fas fa-users"></i> ${user.followers} followers</span>
            ${user.blog ? `<a class="pill" href="${user.blog.startsWith('http')?user.blog:'https://'+user.blog}" target="_blank"><i class="fas fa-globe"></i> website</a>` : ''}
          </div>
        `;

        let langBarsHtml = '';
        if (analysis.langPercentages.length > 0) {
          langBarsHtml = analysis.langPercentages.map(l => `
            <div class="lang-item">
              <span><i class="fas fa-code" style="opacity:0.8;"></i> ${l.lang}</span>
              <div class="bar-bg"><div class="bar-fill" style="width: ${l.percent}%;"></div></div>
              <span class="lang-percent">${l.percent}%</span>
            </div>
          `).join('');
        } else {
          langBarsHtml = '<div class="lang-item">No language data</div>';
        }

        const suggestionsHtml = analysis.suggestions.map(s => `
          <li class="suggestion-item"><i class="fas fa-chevron-circle-right" style="color:#b48aff;"></i> ${s.text} <span class="suggestion-tagline">${s.tagline || ''}</span></li>
        `).join('');

        return `<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‚ú® ${user.login} ¬∑ GitSpark analysis</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      background: #0b0720;
      font-family: 'Inter', system-ui, sans-serif;
      padding: 2.5rem 2rem;
      display: flex;
      justify-content: center;
      background: radial-gradient(circle at 10% 20%, #312359, #0b0720 90%);
      color: #edeafb;
    }
    .result-container {
      max-width: 1200px;
      width: 100%;
    }
    .close-link {
      margin-bottom: 1.5rem; display: inline-block; color: #c6b3ff;
      font-size: 1.1rem; text-decoration: none; border: 1px solid #6b4f9e; padding: 0.5rem 1.8rem; border-radius: 40px;
      backdrop-filter: blur(6px);
    }
    .close-link i { margin-right: 8px; }
    .results-grid {
      display: grid;
      grid-template-columns: 1.2fr 1.6fr;
      gap: 25px;
    }
    .glass-panel {
      background: rgba(20, 12, 45, 0.6);
      backdrop-filter: blur(15px);
      border: 1px solid #a281df50;
      border-radius: 40px;
      padding: 1.8rem 2rem;
      box-shadow: 0 30px 60px -15px black;
    }
    .panel-title {
      text-transform: uppercase; font-size: 0.9rem; letter-spacing: 2px;
      color: #b5a1f0; margin-bottom: 1rem; display: flex; align-items: center; gap: 8px;
    }
    .big-score {
      font-size: 6rem; font-weight: 800;
      background: linear-gradient(145deg, #f0d6ff, #fbbf24);
      -webkit-background-clip: text; background-clip: text; color: transparent;
      line-height: 1;
    }
    .score-label { color: #b9a6e3; font-size: 1rem; margin: 0.5rem 0 1rem; }
    .metrics-grid {
      display: grid; grid-template-columns: 1fr 1fr; gap: 1rem 2rem;
    }
    .metrics-label { font-size:0.85rem; color:#ab99d9; grid-column: 1; }
    .metrics-value { font-weight:600; grid-column: 2; }
    .profile-avatar { width:70px; height:70px; border-radius:50%; border:3px solid #b48aff; }
    .profile-primary { display: flex; flex-direction: column; }
    .profile-name { font-size:1.4rem; font-weight:600; }
    .profile-login { color:#c3adff; text-decoration:none; }
    .profile-bio { grid-column:1/-1; color: #cdbef5; margin: 10px 0 5px; }
    .profile-meta { grid-column:1/-1; display: flex; flex-wrap: wrap; gap: 10px; }
    .pill {
      background: rgba(0,0,0,0.4); border:1px solid #8a71c7; padding:5px 14px; border-radius:60px;
      font-size:0.85rem; display:inline-flex; align-items:center; gap:6px; color:#e1d2ff;
    }
    .elite-pulse { background:#8b3ad9; border-color:gold; color:white; animation: pulse 2s infinite; }
    @keyframes pulse { 0% { box-shadow:0 0 0 0 #eab308; } 70% { box-shadow:0 0 15px 5px #fbbf24; } }
    .lang-section {
      grid-column:1/-1; background: rgba(10,5,30,0.7); border-radius:40px; padding:1.8rem 2rem;
      border:1px solid #8f76cf;
      display: flex; flex-wrap: wrap; align-items: center; gap: 30px;
    }
    .lang-item { display: flex; align-items: center; gap: 12px; min-width: 200px; }
    .bar-bg { width:130px; height:10px; background:#30284d; border-radius:20px; }
    .bar-fill { height:100%; background: linear-gradient(90deg,#b57eff,#ecb2ff); border-radius:20px; }
    .lang-percent { font-size:0.8rem; color:#bba6ff; }
    .suggestions-list { list-style: none; }
    .suggestion-item { margin-bottom: 16px; display: flex; flex-direction: column; gap: 4px; }
    .suggestion-tagline { font-size:0.8rem; color:#ab99d9; margin-left: 28px; }
  </style>
</head>
<body>
  <div class="result-container">
    <a href="#" onclick="window.close();return false;" class="close-link"><i class="fas fa-arrow-left"></i> close & go back</a>
    <div class="results-grid">
      <!-- overall score panel -->
      <div class="glass-panel" style="grid-row: span 2;">
        <div class="panel-title"><i class="fas fa-trophy"></i> overall score</div>
        <div class="big-score">${analysis.overall}</div>
        <div class="score-label">${scoreDesc}</div>
        ${eliteBadge}
      </div>
      <!-- metrics (now with the four core metrics) -->
      <div class="glass-panel">
        <div class="panel-title"><i class="fas fa-chart-pie"></i> breakdown</div>
        <dl class="metrics-grid">${metricsHtml}</dl>
      </div>
      <!-- profile snapshot -->
      <div class="glass-panel">
        <div class="panel-title"><i class="fas fa-id-badge"></i> profile snapshot</div>
        <div style="display: grid; grid-template-columns: auto 1fr; gap: 15px; align-items: center;">${profileHtml}</div>
      </div>
      <!-- language distribution -->
      <div class="lang-section">
        <span class="panel-title" style="margin:0;"><i class="fas fa-code"></i> language distribution</span>
        <div style="display: flex; flex-wrap: wrap; gap: 25px;">${langBarsHtml}</div>
      </div>
      <!-- suggestions -->
      <div class="glass-panel" style="grid-column:1/-1;">
        <div class="panel-title"><i class="fas fa-lightbulb"></i> improvement suggestions</div>
        <ul class="suggestions-list">${suggestionsHtml}</ul>
      </div>
    </div>
  </div>
</body>
</html>`;
      }

      function describeScore(s) {
        if (s>=90) return "World-class ‚Äî legendary portfolio";
        if (s>=80) return "Excellent ‚Äî minor tweaks to shine";
        if (s>=65) return "Solid foundation ‚Äî build consistency";
        if (s>=50) return "Emerging ‚Äî focus on one standout project";
        return "Early stage ‚Äî start building & documenting";
      }
    })();
  </script>
</body>
</html>
